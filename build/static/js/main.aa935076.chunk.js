(this.webpackJsonpvoting=this.webpackJsonpvoting||[]).push([[0],{31:function(e,t,n){},65:function(e,t,n){"use strict";n.r(t);var s=n(1),c=n.n(s),r=n(32),o=n.n(r),a=n(9),u=n(3),i=n(35),j=n(2),l=n(11),b=n(15),d=n.n(b),m=n(0),h=c.a.createContext(),O=d.a.create();function f(e){var t={user:JSON.parse(localStorage.getItem("user"))||{},token:localStorage.getItem("token")||"",userComments:[],issueComments:[],errMsg:"",issues:[]},n=Object(s.useState)(t),c=Object(l.a)(n,2),r=c[0],o=c[1];function a(e){o((function(t){return Object(j.a)(Object(j.a)({},t),{},{errMsg:e})}))}var u=function(e){console.log(e,"id"),O.get("/api/comment/search/byUser/".concat(e)).then((function(e){console.log(e),o((function(t){return Object(j.a)(Object(j.a)({},t),{},{userComments:e.data})}))})).catch((function(e){return console.log(e.response.data.errMsg)}))};function b(){O.get("/public").then((function(e){o((function(t){return Object(j.a)(Object(j.a)({},t),{},{issues:e.data})}))})).catch((function(e){return console.log(e.response.data.errMsg)}))}return Object(m.jsx)(h.Provider,{value:Object(j.a)(Object(j.a)({},r),{},{signup:function(e){d.a.post("/auth/signup",e).then((function(e){var t=e.data,n=t.user,s=t.token;localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(n)),b(),o((function(e){return Object(j.a)(Object(j.a)({},e),{},{user:n,token:s})}))})).catch((function(e){return a(e.response.data.errMsg)}))},login:function(e){d.a.post("/auth/login",e).then((function(e){var t=e.data,n=t.user,s=t.token;localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(n)),b(),o((function(e){return Object(j.a)(Object(j.a)({},e),{},{user:n,token:s})})),console.log(n._id,"login"),u(n._id)})).catch((function(e){return a(e.response.data.errMsg)}))},logout:function(){localStorage.removeItem("token"),localStorage.removeItem("user"),o({user:{},token:"",issues:[],userComments:[]}),d.a.get("/").then((function(e){return console.log(e)})).catch((function(e){return console.log(e.response.data.errMsg)}))},addComment:function(e){O.post("/api/comment",e).then((function(e){o((function(t){return Object(j.a)(Object(j.a)({},t),{},{userComments:[].concat(Object(i.a)(t.userComments),[e.data])})}))})).catch((function(e){return console.log(e.response.data.errMsg)}))},selectIssue:b,getUserComments:u,selectIssueThread:function(e){console.log(e.issue,"issue ID"),O.get("/public/search/byIssue/".concat(e.issue)).then((function(e){console.log(e,"please respond"),o((function(t){return Object(j.a)(Object(j.a)({},t),{},{issueComments:e.data})}))})).catch((function(e){return console.log(e.response.data.errMsg)}))},resetError:function(){o((function(e){return Object(j.a)(Object(j.a)({},e),{},{errMsg:""})}))}}),children:e.children})}function p(){var e=Object(s.useContext)(h),t=e.logout,n=e.token;return Object(m.jsxs)("div",{className:"NavBar",children:[n&&Object(m.jsx)(a.b,{to:"/profile",children:"Profile"}),Object(m.jsx)(a.b,{to:"/ThreadView",children:"Thread View"}),n&&Object(m.jsx)("button",{onClick:t,children:"Logout"})]})}O.interceptors.request.use((function(e){var t=localStorage.getItem("token");return e.headers.Authorization="Bearer ".concat(t),e}));var x=n(10);function g(e){var t=e.handleChange,n=e.handleSubmit,s=e.errMsg,c=e.inputs,r=c.username,o=c.password;return Object(m.jsx)("div",{id:"please",children:Object(m.jsxs)("form",{onSubmit:n,id:"New",children:[Object(m.jsx)("input",{type:"text",value:r,name:"username",onChange:t,placeholder:"Username"}),Object(m.jsx)("input",{type:"text",value:o,name:"password",onChange:t,placeholder:"Password"}),Object(m.jsx)("button",{children:"Login"}),Object(m.jsx)("p",{style:{backgroundColor:"#c00000",color:"#ffffff",textAlign:"center"},children:s})]})})}function v(e){var t=e.handleChange,n=e.handleSubmit,s=e.errMsg,c=e.inputs,r=c.username,o=c.password,a=c.firstName,u=c.lastName,i=c.phoneNumber;return Object(m.jsx)("div",{id:"please",children:Object(m.jsxs)("form",{onSubmit:n,id:"New",children:[Object(m.jsx)("input",{type:"text",value:a,name:"firstName",onChange:t,placeholder:"First Name"}),Object(m.jsx)("input",{type:"text",value:u,name:"lastName",onChange:t,placeholder:"Last Name"}),Object(m.jsx)("input",{type:"numbers",value:i,name:"phoneNumber",onChange:t,placeholder:"Phone Number"}),Object(m.jsx)("input",{type:"text",value:r,name:"username",onChange:t,placeholder:"Username"}),Object(m.jsx)("input",{type:"text",value:o,name:"password",onChange:t,placeholder:"Password"}),Object(m.jsx)("button",{children:"Sign Up"}),Object(m.jsx)("p",{style:{backgroundColor:"#c00000",color:"#ffffff",textAlign:"center"},children:s})]})})}var C={username:"",password:"",firstName:"",lastName:"",phoneNumber:""};function k(){var e=Object(s.useState)(C),t=Object(l.a)(e,2),n=t[0],c=t[1],r=Object(s.useState)(!1),o=Object(l.a)(r,2),a=o[0],u=o[1],i=Object(s.useContext)(h),b=i.signup,d=i.login,O=i.errMsg,f=i.resetError;function p(e){var t=e.target,n=t.name,s=t.value;c((function(e){return Object(j.a)(Object(j.a)({},e),{},Object(x.a)({},n,s))}))}function k(){u((function(e){return!e})),f()}return Object(m.jsxs)("div",{id:"stuff",children:[Object(m.jsx)("h1",{children:"Rock The Vote in Week 4"}),a?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(g,{handleChange:p,handleSubmit:function(e){e.preventDefault(),d(n)},inputs:n,errMsg:O}),Object(m.jsx)("p",{id:"clicky",onClick:function(){return k()},children:" New? Click to Sign up."})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(v,{handleChange:p,handleSubmit:function(e){e.preventDefault(),b(n)},inputs:n,errMsg:O}),Object(m.jsx)("p",{id:"clicky",onClick:function(){return k()},children:" Switch to Login?"})]})]})}var N={issue:"6135901eb1fbbe3c6c297eff",body:""};function S(e){var t=Object(s.useState)(N),n=Object(l.a)(t,2),c=n[0],r=n[1],o=e.addComment,a=e.issues,u=e.userName;function i(e){var t=e.target,n=t.name,s=t.value;r((function(e){var t;return Object(j.a)(Object(j.a)({},e),{},(t={},Object(x.a)(t,n,s),Object(x.a)(t,"username",u),t))}))}var b=c.issue,d=c.body;return Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o(c),console.log(u,"commentbox"),r(N)},children:[Object(m.jsx)("p",{children:"Choose an Issue:"}),Object(m.jsx)("select",{name:"issue",value:b,onChange:i,children:a.map((function(e){return Object(m.jsx)("option",{value:e._id,children:e.topic},e._id)}))}),Object(m.jsx)("input",{type:"text",name:"body",value:d,onChange:i,placeholder:"Comment"}),Object(m.jsx)("button",{children:"Comment"})]})}function y(e){var t=e.body,n=e.datePosted,c=e.issue;console.log(e,"props");var r=Object(s.useContext)(h),o=r.issues,a=r.user.username;console.log(a,"usercomment");var u=o.filter((function(e){return c===e._id}));return Object(m.jsxs)("div",{className:"comment",children:[Object(m.jsx)("h1",{children:u[0].topic}),Object(m.jsx)("p",{children:t}),Object(m.jsxs)("h5",{children:["Written by: ",a," on ",n," "]})]})}function I(e){var t=e.userComments;return Object(m.jsx)("div",{className:"comments",children:t.map((function(e){return Object(s.createElement)(y,Object(j.a)(Object(j.a)({},e),{},{key:e._id}))}))})}function w(){var e=Object(s.useContext)(h),t=e.user,n=t.firstName,c=t.lastName,r=t.username,o=e.addComment,a=e.issues,u=e.userComments;return console.log(u,"profile"),Object(m.jsxs)("div",{className:"profile",children:[Object(m.jsxs)("h1",{children:[" Welcome ",n," ",c,", you are commenting as @",r]}),Object(m.jsx)("h3",{children:"Make a comment"}),Object(m.jsx)(S,{addComment:o,issues:a,userName:r}),Object(m.jsx)("h3",{children:"View Your Comments"}),Object(m.jsx)(I,{userComments:u,issues:a})]})}function M(e){var t=e.body,n=e.datePosted,s=e.username;return Object(m.jsxs)("div",{className:"comment",children:[Object(m.jsx)("p",{children:t}),Object(m.jsxs)("h5",{children:["Written by: ",s," on ",n," "]})]})}function T(e){var t=e.inputs,n=Object(s.useContext)(h),c=n.issueComments,r=n.issues;console.log(t.issue,"threadview");r.filter((function(e){return t.issue===e._id}));return Object(m.jsx)("div",{children:Object(m.jsx)("div",{className:"comments",children:c.map((function(e){return Object(s.createElement)(M,Object(j.a)(Object(j.a)({},e),{},{key:e._id}))}))})})}var _={issue:"6135901eb1fbbe3c6c297eff"};function P(e){var t=Object(s.useState)(_),n=Object(l.a)(t,2),c=n[0],r=n[1],o=e.selectIssueThread,a=e.username,u=Object(s.useContext)(h),i=u.issues,b=u.selectIssue;Object(s.useEffect)((function(){b()}),[]);var d=c.issue;return Object(m.jsxs)("div",{children:[Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o(c)},children:[Object(m.jsx)("p",{children:"Choose an Issue:"}),Object(m.jsx)("select",{name:"issue",value:d,onChange:function(e){var t=e.target,n=t.name,s=t.value;r((function(e){return Object(j.a)(Object(j.a)({},e),{},Object(x.a)({},n,s))}))},children:i.map((function(e){return Object(m.jsx)("option",{value:e._id,children:e.topic},e._id)}))}),Object(m.jsx)("button",{children:" View "})]}),Object(m.jsx)(T,{inputs:c,username:a,issues:i})]})}function V(){var e=Object(s.useContext)(h),t=e.user.username,n=e.issueComments,c=e.selectIssueThread,r=e.issues;return Object(m.jsxs)("div",{className:"ThreadView",children:[Object(m.jsx)(a.b,{to:"/",children:"Back to Login"}),Object(m.jsx)("h1",{children:"Select an Issue Thread"}),Object(m.jsx)(P,{selectIssueThread:c,issueComments:n,username:t,issues:r})]})}var E=n(36),D=["path","redirectTo","component","token"];function J(e){var t=e.path,n=e.redirectTo,s=e.component,c=e.token,r=Object(E.a)(e,D);return c?Object(m.jsx)(u.b,{path:t,render:function(){return Object(m.jsx)(s,Object(j.a)({},r))}}):Object(m.jsx)(u.a,{to:n})}n(31);var L=function(){var e=Object(s.useContext)(h),t=e.token,n=e.logout;return Object(m.jsxs)("div",{className:"app",children:[Object(m.jsx)(p,{logout:n}),Object(m.jsxs)(u.d,{children:[Object(m.jsx)(u.b,{exact:!0,path:"/",render:function(){return t?Object(m.jsx)(u.a,{to:"/profile"}):Object(m.jsx)(k,{})}}),Object(m.jsx)(J,{path:"/profile",component:w,redirectTo:"/",token:t}),Object(m.jsx)(u.b,{path:"/ThreadView",component:V})]})]})};o.a.render(Object(m.jsx)(a.a,{children:Object(m.jsx)(f,{children:Object(m.jsx)(L,{})})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.aa935076.chunk.js.map